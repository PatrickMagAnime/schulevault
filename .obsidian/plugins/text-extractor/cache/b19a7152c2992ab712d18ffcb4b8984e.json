{"path":"stefan/obsidianschule/2.Klasse/Itsi/aufgaben/asymetrische verschlÃ¼sselung/Asymmetrische_Verschluesselung.pdf","text":"1 / 7 1. Asymmetrische VerschlÃ¼sselung einfach erklÃ¤rt (http://www.dkruse.de, Dirk Kruse) Das Prinzip der asymmetrischen VerschlÃ¼sselung beruht im Wesentlichen darauf, dass sich jeder Kommunikationspartner jeweils ein SchlÃ¼sselpaar (bestehend aus zwei SchlÃ¼sseln) erzeugt. Einer der SchlÃ¼ssel wird geheim gehalten, das ist der so genannte private SchlÃ¼ssel. Der zweite SchlÃ¼ssel wird jedem kommunikationswilligen Teilnehmer zugÃ¤nglich gemacht. Der zweite SchlÃ¼ssel heiÃŸt deshalb Ã¶ffentlicher SchlÃ¼ssel. Der groÃŸe Vorteil dieses Verfahrens im Vergleich zur symmetrischen VerschlÃ¼sselung1 ist in der einfachen Verteilung des Ã¶ffentlichen SchlÃ¼ssels begrÃ¼ndet. Dieser kann wirklich fÃ¼r jeden Menschen frei zugÃ¤nglich sein, ohne dass dadurch das Verfahren unsicher wird. Das VerstÃ¤ndnis asymmetrische VerschlÃ¼sselungsverfahren setzt einige mathematische Kenntnisse voraus (siehe Abschnitt 2). Das folgende Beispiel kommt jedoch ganz ohne Mathematik aus. Zum besseren VerstÃ¤ndnis wird hier der Ã¶ffentliche SchlÃ¼ssel durch ein VorhÃ¤ngeschloss symbolisieret und der private SchlÃ¼ssel durch den passenden SchlÃ¼ssel fÃ¼r dieses Schloss. Nehmen wir nun an, Bob mÃ¶chte eine Nachricht an Alice schicken. Alice will aber verhindern, dass ihr Vater lesen kann, was Bob und andere Freunde so alles schreiben. Dazu wird sie also als Erstes einige SchlÃ¶sser anfertigen, die nur von einem (nÃ¤mlich ihrem) SchlÃ¼ssel geÃ¶ffnet werden kÃ¶nnen. Dann wird sie ihre (offenen!) SchlÃ¶sser an ihre Freunde verteilen, also auch an Bob. Bob hat nun ein offenes Schloss von Alice2, welches er zwar schlieÃŸen kann, aber ohne passenden SchlÃ¼ssel nicht wieder zu Ã¶ffnen vermag (Alice darf ihren SchlÃ¼ssel natÃ¼rlich auf keinen Fall bekannt geben). Also fÃ¤ngt Bob an, seinen Brief zu schreiben, steckt ihn in eine Kiste und verschlieÃŸt diese mit dem Schloss von Alice. Abgesehen von Alice ist nun niemand mehr in der Lage, die Kiste zu Ã¶ffnen und den Brief zu lesen. Die Kiste macht sich nun auf die Reise und erreicht irgendwann Alice, welche mit ihrem SchlÃ¼ssel das Schloss Ã¶ffnet, den Brief der Kiste entnimmt, liest und froh ist, dass ihr Vater Bobs Brief nicht lesen konnte. 1 Symmetrische VerschlÃ¼sselung ist die gebrÃ¤uchlichste Methode zur Geheimhaltung vor Dritten: Alle Teil- nehmenden kennen den geheimen Code, mit dem sowohl ver- als auch entschlÃ¼sselt wird. Jeder Mensch, der den gemeinsamen Code kennt, kann die verschlÃ¼sselten Daten lesen und verstehen. 2 Besonders wichtig ist die korrekte Ãœbergabe des Schlosses! Bob muss sich sicher sein kÃ¶nnen, ein Schloss von Alice zu benutzen. Bestenfalls telefoniert er mit Alice und lÃ¤sst sich das Schloss genauestens beschreiben. 2 / 7 Alice kann sich absolut sicher sein, dass niemand nach Ver- schlieÃŸen der Kiste den Brief lesen konnte. Selbst Bob hatte nicht mehr die MÃ¶glichkeit, den Brief zu lesen, geschweige denn zu Ã¤ndern, da nur Alice den passenden SchlÃ¼ssel zum Schloss besitzt. Der angesprochene Vorteil der Ã¶ffentlichen SchlÃ¼sselÃ¼bertragung besteht also darin, dass prinzipiell jeder ein Schloss von Alice benutzen kann, um Kisten zu verschlieÃŸen, aber nur sie in der Lage ist, diese wieder zu Ã¶ffnen. Alice braucht sich zum Gedankenaustausch also nicht unter vier Augen mit Bob zu treffen, was ihr Vater vielleicht gar nicht zulassen wÃ¼rde. Ein Nachteil besteht allerdings darin, dass Alice sich nicht sicher sein kann, ob die Nachricht wirklich von Bob stammt oder ob irgendjemand 3 einfach eines ihrer SchlÃ¶sser genommen und damit irgendeine Kiste verschlossen hat. Dazu muss sich Bob noch etwas einfallen lassen (z. B. Unterschrift, Blutspritzer, ... ïƒ  Alice kann damit eine AuthentizitÃ¤tsprÃ¼fung4 vornehmen). Das Beispiel mit den SchlÃ¶ssern hilft zwar prima bei VerstÃ¤ndnis der asymmetrischen VerschlÃ¼sselung, ist in der Praxis nur leider nicht wirklich sicher. So wÃ¼rde ein groÃŸer Bolzenschneider das Problem des SchlossÃ¶ffnens fÃ¼r den Vater von Alice vermutlich schon lÃ¶sen. Wer bis hierher alles verstanden hat und nun mehr wissen mÃ¶chte, sollte auf den nÃ¤chsten Seiten weiter lesen. Dort wird das sehr sichere und in der Praxis hÃ¤ufig genutzte asymmetrische VerschlÃ¼sselungsverfahren RSA an einem Beispiel erklÃ¤rt. Was an mathematischen Verfahren notwendig ist, wird im Abschnitt 2 so weit wie nÃ¶tig erklÃ¤rt. Bei schwierigen Operationen helfen der Windows-Taschenrechner und z.B. eine Excel-Tabelle weiter. Quelle: http://www.cryptocd.org/online_version/aktuell/doku/windows/asymmetrie/asymmetrie.html (recherchiert am 5.1.2007) 3 Alice' Vater kÃ¶nnte sein Schloss Bob unterjubeln (als angebliches Schloss von Alice). Bob wÃ¼rde also die Kiste nicht mit dem Schloss von Alice verschliessen, sondern mit dem ihres Vaters. Dieser kÃ¶nnte die Kiste dann bequem mit seinem zugehÃ¶rigen SchlÃ¼ssel Ã¶ffnen, den Brief lesen/manipulieren/zensieren und die Kiste mit Alice' Schloss (welches er ja auch hat, weil es per Definition Ã¶ffentlich ist) an Alice weiterleiten. Davon wÃ¼rde Alice nichts mitbekommen, da sie wie immer eine Kiste mit einem Brief erhÃ¤lt, verschlossen mit ihrem Schloss. Dieses Vorgehen wird Ã¼brigens Man-in-the-Middle-Attacke genannt. 4 Das Problem der fÃ¤lschungssicheren Unterschrift ist jedoch auch mit den Werkzeugen der asymmetrischen VerschlÃ¼sselung lÃ¶sbar. Dazu erstellt Alice mit ihrem privaten SchlÃ¼ssel eine Signatur, anhand derer Bob mit Alice' Ã¶ffentlichem SchlÃ¼ssel die Herkunft der Nachricht Ã¼berprÃ¼fen kann 3 / 7 2. Das RSA-Verfahren RSA hat den Namen nach den Anfangsbuchstaben der Nachnamen seiner Erfindern RONALD L. RIVEST, ADI SHAMIR und LEONARD ADLEMAN bekommen. RIVEST, SHAMIR und ADLEMAN haben das Verfahren 1977 entwickelt. Es gilt bis heute als sicher. Die RSA-VerschlÃ¼sselung nutzt sogenannte Einweg-Funktionen. Man kann sich diese Funktionen als mathematische EinbahnstraÃŸen vorstellen. In die eine Richtung (VerschlÃ¼sseln) ist die Berechnung ganz einfach. Versucht man den Rechenweg jedoch rÃ¼ckwÃ¤rts zu beschreiten (EntschlÃ¼sseln ohne SchlÃ¼ssel), wird die Sache sehr viel schwieriger. Ein Beispiel fÃ¼r eine Einweg-Funktion ist die Multiplikation von Primzahlen. Zur Wiederholung: Eine Primzahl ist nur durch sich selbst und 1 teilbar. Es ist sehr einfach, zwei Primzahlen zu multiplizieren. Nehmen wir 3.259 und 5.431. Das Produkt liefert jeder Taschenrechner in Sekundenbruchteilen, es lautet 17.699.629. Die mathematische EinbahnstraÃŸe wurde hierbei in der einfachen (richtigen) Richtung â€befahrenâ€œ. Wenn die Frage nun aber lauten wÃ¼rde: â€Gesucht sind alle Teiler der Zahl 17.699.629â€œ sieht die Sache sehr viel schwieriger aus. Jetzt mÃ¼ssen wir die EinbahnstraÃŸe in die andere Richtung zurÃ¼ck fahren. Das ist im StraÃŸenverkehr verboten und in der Mathematik fÃ¼r diese Aufgabe sehr schwierig. 17.699.629 hat nÃ¤mlich nur vier Teiler: 1 und sich selbst (das gilt immer und fÃ¼r jede Zahl) sowie die beiden Primzahlen, die wir gerade zuvor multipliziert haben. Das bedeutet, wenn man aus dem Produkt 17.699.629 alle Teiler, auÃŸer 1 und der Zahl selbst, findet, hat man die Ausgangswerte ermittelt. Das groÃŸe Problem dabei ist, dass fÃ¼r das Zerlegen einer Zahl in ihre Primfaktoren auf der ganzen Welt kein wirklich guter (d. h. schneller) Algorithmus bekannt ist. Versuchen Sie doch einmal die Faktoren fÃ¼r das Produkt 55.141 zu finden. Kleine Hilfe: es sind natÃ¼rlich wieder zwei Primzahlen .... ... Na, hatten Sie Erfolg? 55.141 ist keine groÃŸe Zahl, trotzdem werden Sie die LÃ¶sung erst nach einiger Zeit und durch Probieren gefunden haben. Wenn nicht, die LÃ¶sung steht am Ende dieses Textes. Man kann natÃ¼rlich einwerfen, dass mit Hilfe eines Computers diese Faktoren schnell ermittelt werden kÃ¶nnen. Richtig ist das aber nur, wenn das Produkt nicht zu groÃŸ wird. Dazu ein Beispiel: Ein 39-stelliges Produkt aus zwei 20-stelligen Primzahlen wird auf einem aktuellen Computer mit Hilfe einer leistungsfÃ¤higen (und Ã¼brigens teuren) Mathematik-Software in weniger als einer Sekunde in die beiden Primzahl-Faktoren zerlegt. FÃ¼r eine 41-stellige Zahl dauert das Ganze schon etwas mehr als 8 Minuten. FÃ¼r ein 43-stelliges Produkt aus zwei 22-stelligen Primzahlen benÃ¶tigte der Computer fast 19 Minuten. Bei einem 44-stelligen Produkt hat das Programm die Berechnung ohne Ergebnis abgebrochen. In der Praxis wird mit 150-stelligen Primfaktoren gearbeitet. Es wird schnell klar, dass auch der schnellste Computer der Welt aus dem 300-stelligen Produkt die beiden Primzahl-Faktoren nicht in akzeptabler Zeit ermitteln und damit die VerschlÃ¼sselung ohne SchlÃ¼ssel knacken kann. Und sollte doch irgendwann einmal ein Computer oder ein Verbund von vielen Computern schnell genug fÃ¼r die Ermittlung der Primfaktoren sein, muss man nur die Anzahl der Stellen der verwendeten Primzahlen erhÃ¶hen und schon ist man wieder auf der sicheren Seite. Dem Besitzer des privaten SchlÃ¼ssels muss es allerdings mÃ¶glich sein, die mit dem Ã¶ffentlichen SchlÃ¼ssel erzeugte Nachricht relativ leicht zu entschlÃ¼sseln. Man bezeichnet Funktionen, die mit einer Zusatzinformation auch rÃ¼ckwÃ¤rts leicht zu berechnen sind, als FalltÃ¼rfunktionen. Einen solchen mathematischen Zusammenhang gefunden zu haben, ist das Verdienst von RONALD L. RIVEST, ADI SHAMIR und LEONARD ADLEMAN. 4 / 7 Im Folgenden wird Schritt fÃ¼r Schritt dieses mathematische Verfahren mit ganz kleinen Primzahlen und einer sehr kurzen Nachricht, die nur aus einem Zeichen besteht, erklÃ¤rt. Keine Angst, wir orientieren uns am Beispiel des Abschnitts 1. Voraussetzung fÃ¼r das VerstÃ¤ndnis ist jedoch die mathematische Rechenoperation Modulo. Die Operation Modulo liefert den Rest, der bei einer ganzzahligen Division entsteht. Beispiele: 20 : 6 = 3 Rest 2, denn 3 âˆ™ 6 = 18 ïƒ 18 + 2 = 20 = 20 = ïƒ  20 mod 6 = 2 20 mod 6 = 3 43 : 5 = 8 Rest 3, denn 8 âˆ™ 5 = 40 ïƒ 40 + 3 = 43 = 43 = ïƒ  43 mod 5 = 3 43 48 : 5 = 9 Rest 3, denn 9 âˆ™ 5 = 45 ïƒ 45 + 3 = 48 = 48 = ïƒ  48 mod 5 = 3 48 Verstanden? Dann kann es jetzt losgehen! (1) Alice erzeugt zuerst Ihren privaten SchlÃ¼ssel Dazu wÃ¤hlt sie zwei Primzahlen, z. B. p = 17 und q = 11. Diese beiden Zahlen muss Alice geheim halten! Nun wÃ¤hlt Alice noch eine weitere Zahl e. Nehmen wir an, sie wÃ¤hlt e = 7. Dabei sollten e und ((p-1) âˆ™ (q-1)) teilerfremd sein, d. h. der grÃ¶ÃŸte gemeinsamer Teiler von e und ((p-1) âˆ™ (q-1)) ist 1. Die Wahl einer weiteren Primzahl erhÃ¶ht die Chance, eine passende Zahl fÃ¼r e zu finden. Den eigentlichen privaten SchlÃ¼ssel d berechnet Sie dann aus p, q und e mit der Formel 1 = (e Â· d) mod ((p - 1) Â· (q â€“ 1)) Mit den eingesetzten Werten fÃ¼r e, p und q lautet die Gleichung: 1 = (7 Â· d) mod ((17 - 1) Â· (11 â€“ 1) 1 = (7 Â· d) mod ((16) Â· (10)) 1 = (7 Â· d) mod 160 FÃ¼r d = 23 stimmt die Gleichung: 1 = (7 Â· 23) mod 160 = 161 mod 160 (2) Alice erzeugt dann Ihren Ã¶ffentlichen SchlÃ¼ssel Der Ã¶ffentliche SchlÃ¼ssel besteht aus zwei Zahlen. Als erste Zahl verwendet Alice die Zahl e = 7 aus dem ersten Schritt. Zur Berechnung der zweiten Zahl wÃ¤hlt sie zwei Primzahlen, z. B. p = 17 und q = 11. Alice multipliziert 17 und 11 und erhÃ¤lt das Produkt N = 187. Die Zahlen N und e sind Aliceâ€™ Ã¶ffentlicher SchlÃ¼ssel. (3) Die zu verschlÃ¼sselnde Nachricht wird in eine Zahl M umgewandelt. Das kann mit dem ASCII-Code geschehen. Nehmen wir an, Bob mÃ¶chte Alice den Buchstaben X als symbolischen Kuss schicken. Das X hat im ASCII-Code den Dezimalwert 88. Daraus folgt M = 88. (4) Jetzt kann Bob die Zahl M verschlÃ¼sseln und erzeugt die verschlÃ¼sselte Nachricht C. Die VerschlÃ¼sselung von M zu C erfolgt mit der Formel ğ¶ = ğ‘€ğ‘’ ğ‘šğ‘œğ‘‘ ğ‘ 5 / 7 Die Ã¶ffentlichen SchlÃ¼ssel e = 7 und N = 187 von Alice kennt Bob. Also kann er sie in die Formel einsetzen. Die umgewandelte Zahl M ist ebenfalls verfÃ¼gbar, da es sich um die in eine Zahl umgewandelte Nachricht von Bob handelt. Bob rechnet also: ğ¶ = 887 ğ‘šğ‘œğ‘‘ 187 Mit der wissenschaftlichen Ansicht des Windows-Rechners erhÃ¤lt man ğ¶ = 40867559636992 ğ‘šğ‘œğ‘‘ 187 = 11 Bob kann diese Nachricht selbst nicht entschlÃ¼sseln. Angenommen, er wollte noch einmal Ã¼berprÃ¼fen, ob er wirklich ein X als Symbol fÃ¼r den Kuss geschickt hat, so wÃ¤re ihm das nicht mÃ¶glich. Denn fÃ¼r die Gleichung 11 = x7 mod 187 gibt es unendlich viele LÃ¶sungen, z. B. x = 88, x = 275. Allgemein gilt fÃ¼r dieses Beispiel: x1 = 88, x2 = x1 + 187, ...., xn+1 = xn + 187. Bob schickt die verschlÃ¼sselte Nachricht C = 11 nun an Alice. (5) Alice entschlÃ¼sselt die empfangene Nachricht C. Dazu benÃ¶tigt sie ihren privaten SchlÃ¼ssel d = 23 und den Teil des Ã¶ffentlichen SchlÃ¼ssels N = 187. Die Formel zur Berechnung der Originalnachricht lautet: ğ‘€ = ğ¶ğ‘‘ ğ‘šğ‘œğ‘‘ ğ‘ Mit eingesetzten Zahlenwerten und dem Windows-Rechner ergibt sich: ğ‘€ = 1123 ğ‘šğ‘œğ‘‘ 187 ğ‘€ = 895430243255237372246531 ğ‘šğ‘œğ‘‘ 187 ğ‘€ = 88 Das Zeichen im ASCII-Code mit der Nummer 88 ist das X. Alice hat den symbolischen Kuss erhalten. HÃ¤tte ihr Vater den Brief abgefangen, hÃ¤tte er die Zahl 11 gelesen. Der Zahl 11 ist im ASCII- Code aber gar kein Zeichen zugeordnet. Das ist zwar Zufall, aber auch bei einem grÃ¶ÃŸeren ASCII-Dezimalwert kÃ¶nnte Aliceâ€™ Vater nur das verschlÃ¼sselte Zeichen erkennen. Ein RÃ¼ckschluss auf die richtige Nachricht ist ohne Kenntnis von Aliceâ€™ privatem SchlÃ¼ssel nicht mÃ¶glich. Die Wahl der Primzahlen und das Ver- und EntschlÃ¼sseln Ã¼berlassen Alice und Bob ab jetzt einem Computerprogramm. Das Beispiel hat ja gezeigt, dass das Verfahren funktioniert und es wurde erklÃ¤rt, unter welchen Bedingungen es als sicher angesehen werden kann. Deutlich wurde aber auch, dass RSA sehr rechenintensiv ist. So benÃ¶tigt RSA 1000mal mehr Zeit als das symmetrische verschlÃ¼sselungsverfahren DES. Deshalb ist es fÃ¼r lange Nachrichten nicht geeignet. Symmetrische Verfahren haben aber den groÃŸen Nachteil, dass der gemeinsame SchlÃ¼ssel zwischen Sender und EmpfÃ¤nger ausgetauscht werden muss. Und genau dafÃ¼r eignet sich RSA hervorragend. Die SchlÃ¼ssel fÃ¼r die symmetrische VerschlÃ¼sselung werden mit dem asymmetrischen Verfahren RSA ausgetauscht. Denn SchlÃ¼ssel sind im Vergleich zu richtigen Nachrichten sehr kurz. 6 / 7 Literatur: Simon Singh: Geheime Botschaften; Deutscher Taschenbuch Verlag; 6. Auflage; MÃ¼nchen 2005; S. 436 f Software: mit ausfÃ¼hrlichen Anleitungen und Programmen zum sicheren E-Mail-Verkehr unter www.cryptocd.org und www.gpg4win.de/ Anm.: Das Produkt 55.141 wurde aus den Primzahlen 823 mal 67 berechnet. 7 / 7 3. Arbeitsblatt zum Testen der RSA-VerschlÃ¼sselung Jetzt dÃ¼rfen Sie! Legen Sie Ihr SchlÃ¼sselpaar fest und Ã¼bertragen Sie einen selbst gewÃ¤hlten Buchstaben an Ihren Kommunikationspartner! FÃ¼r die Wahl des SchlÃ¼sselpaares benÃ¶tigen Sie Primzahlen. Damit die Berechnungen mit dem Windows-Taschenrechner noch mÃ¶glich sind, verwenden wir nur Primzahlen kleiner als 100. Hier sind alle Primzahlen von 1 â€“ 100: 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97 Damit Sie Ihren zu Ã¼bertragenden Buchstaben in eine Zahl und die Zahl beim Empfang einer Nachricht wieder in einen Buchstaben umwandeln kÃ¶nnen, ist hier die Liste der deutschen GroÃŸbuchstaben des ASCII-Code: 65 = A 66 = B 67 = C 68 = D 69 = E 70 = F 71 = G 72 = H 73 = I 74 = J 75 = K 76 =L 77 = M 78 = N 79 = O 80 = P 81 = Q 82 = R 83 = S 84 = T 85 = U 86 = V 87 = W 88 = X 89 = Y 90 = Z Nachricht mit RSA verschlÃ¼sseln Nachricht mit RSA entschlÃ¼sseln E: Vorbereitungen: p wÃ¤hlen: ___________ (Primzahl-Liste) q wÃ¤hlen: ___________ (Primzahl-Liste) e wÃ¤hlen: ___________ (Primzahl-Liste) E: VerschlÃ¼sselte Nachricht C und privaten SchlÃ¼ssel d bereit halten: C: ___________ d: ___________ E: Privaten SchlÃ¼ssel aus p, q und e ermitteln: d berechnen: ___________ E: Teil N des Ã¶ffentlichen SchlÃ¼ssels bereit halten N: ___________ E: Ã–ffentlichen SchlÃ¼ssel aus p, q und e ermitteln: N berechnen: ___________ (N = p Â· q) e notieren: ___________ (siehe oben) E: C entschlÃ¼sseln, um M zu erhalten: M = C d mod N M = ________ (Windows-Taschenrechner) E: Ã–ffentlichen SchlÃ¼ssel (N, e) an Sender Ã¼bermitteln E: Zahl M in ASCII-Zeichen umwandeln: ASCII-Zeichen: __________ (ASCII-Liste) S: Zeichen, das Ã¼bertragen werden soll, bestimmen: ASCII-Zeichen: __________ ASCII-Nummer M: __________ (ASCII-Liste) E: hat die Nachricht entschlÃ¼sselt. Das ASCII-Zeichen ist die ursprÃ¼ngliche Nachricht des Senders. S: Zahl M verschlÃ¼sseln: C = M e mod N = __________ (Win-Rechner) S: VerschlÃ¼sselte Nachricht C an EmpfÃ¤nger E Ã¼bermitteln E steht fÃ¼r die TÃ¤tigkeiten, die der EmpfÃ¤nger der Nachricht ausfÃ¼hren muss, S fÃ¼r die Aufgaben, die der Sender der Nachricht abarbeiten muss.","libVersion":"0.3.2","langs":""}